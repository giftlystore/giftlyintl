<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Giftly | Deliver Gift</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="listing.js"></script>

      <!-- Smartsupp Live Chat script -->
    <script type="text/javascript">
    var _smartsupp = _smartsupp || {};
    _smartsupp.key = '5b99a2a99b90497b27aa80d08a784b475fae365e';
    window.smartsupp||(function(d) {
      var s,c,o=smartsupp=function(){ o._.push(arguments)};o._=[];
      s=d.getElementsByTagName('script')[0];c=d.createElement('script');
      c.type='text/javascript';c.charset='utf-8';c.async=true;
      c.src='https://www.smartsuppchat.com/loader.js?';s.parentNode.insertBefore(c,s);
    })(document);
    </script>
    <noscript> Powered by <a href=‚Äúhttps://www.smartsupp.com‚Äù target=‚Äú_blank‚Äù>Smartsupp</a>
    </noscript>

<style>
/* Keep all your existing styles unchanged */
*{box-sizing:border-box;margin:0;padding:0;font-family:'Segoe UI',sans-serif}
body{background:#f6f7fb;color:#222}
.navbar{display:flex;justify-content:space-between;align-items:center;padding:14px 20px;background:#fff;box-shadow:0 4px 14px rgba(0,0,0,.06);position:sticky;top:0;z-index:10}
.logo{font-size:20px;font-weight:800;color:#7a3df0}a{text-decoration:none;color:#333;font-weight:600;font-size:14px}
.container{max-width:1100px;margin:30px auto;padding:0 16px;display:grid;grid-template-columns:1.2fr 1fr;gap:24px}
.image-card{background:#fff;border-radius:18px;overflow:hidden;box-shadow:0 8px 24px rgba(0,0,0,.08)}
.image-card img{width:100%;height:380px;object-fit:cover}
.details-card{display:flex;flex-direction:column;background:#fff;border-radius:18px;padding:22px;box-shadow:0 8px 24px rgba(0,0,0,.08);gap:20px}
h2{font-size:22px;margin-bottom:6px}
.price-old{text-decoration:line-through;color:#888;font-size:14px}
.price-new{font-size:20px;font-weight:800;color:#7a3df0;margin-bottom:16px}
.field{margin-bottom:14px;position:relative}
label{font-size:13px;font-weight:700;display:block;margin-bottom:6px}
input,textarea{width:100%;padding:10px 12px;border-radius:10px;border:1px solid #ddd;font-size:14px}
textarea{resize:none;height:80px}
.notice-inline{font-size:12px;color:#b22222;margin-top:4px;display:none}
.qty-wrap{display:flex;gap:10px;align-items:center}
.qty-btn{width:36px;height:36px;border:none;border-radius:50%;background:#eaeaf5;font-size:18px;font-weight:700;cursor:pointer}
.qty-value{font-size:16px;font-weight:700}
.total-box{margin-bottom:16px;display:flex;justify-content:space-between;gap:10px;}
.total-amount{font-size:24px;font-weight:800;color:#7a3df0}
.send-btn{width:100%;margin-top:16px;padding:12px;border:none;border-radius:12px;background:#7a3df0;color:#fff;font-size:15px;font-weight:700;cursor:pointer}
.send-btn:hover{background:#5f2fd6}
.copy-btn{margin-top:8px;padding:8px 12px;font-size:13px;border:none;border-radius:8px;background:black;color:#fff;cursor:pointer;opacity:0.5}
.copy-btn.enabled{opacity:1;cursor:pointer}
.copy-btn.copied{background:#16a34a}
.notice{margin-top:18px;background:#faf9ff;border-left:4px solid #7a3df0;padding:14px;border-radius:12px;font-size:13px;color:#333}
.success-box{margin-top:18px;background:#eafff3;border:1px solid #3ddc97;padding:14px;border-radius:12px;font-size:14px;display:none}
@media(max-width:900px){.container{grid-template-columns:1fr}.image-card img{height:280px}}
</style>
</head>
<body>

<div class="navbar">
  <div class="logo">üéÅ Giftly</div>
  <div style="display: flex; gap: 25px;">
    <a href="index.html">Home</a>
    <a href="help.html">Help</a>
  </div>

</div>

<div class="container">

  <div class="image-card">
    <img id="productImage" src="">
  </div>

  <div class="details-card">
    <h2 id="productName"></h2>
    <div style="display:flex;justify-content:space-between;">
      <p style="font-size:13px;font-weight:700;">Unit Price</p>
      <p style="gap:10px;font-size:13px;font-weight:700;">
        <span class="price-old" id="oldPrice"></span>
        <span class="price-new" id="newPrice"></span>
      </p>
    </div>

    <div class="field">
      <label>Quantity</label>
      <div class="qty-wrap">
        <button class="qty-btn" onclick="changeQty(-1)">‚àí</button>
        <span class="qty-value" id="qty">1</span>
        <button class="qty-btn" onclick="changeQty(1)">+</button>
      </div>
    </div>

    <div class="total-box">
      <p style="font-size:13px;font-weight:700;">Total</p>
      <div class="total-amount" id="totalAmount">$0</div>
    </div>

    <div class="field">
      <label>Printed Note (optional)</label>
      <textarea id="note"></textarea>
    </div>

    <div class="field">
      <label>Sender Name (optional)</label>
      <input id="senderName" placeholder="Your name">
    </div>

    <div class="field">
      <label>Recipient Name *</label>
      <input id="recipientName" placeholder="Full name" oninput="checkFields()">
      <div class="notice-inline" id="recipientNotice">Recipient Name is required</div>
    </div>

    <div class="field">
      <label>Delivery Address *</label>
      <textarea id="address" placeholder="Full delivery address" oninput="checkFields()"></textarea>
      <div class="notice-inline" id="addressNotice">Delivery Address is required</div>
    </div>

    <button class="send-btn" onclick="sendDelivery()">Send for Delivery</button>
    <button class="copy-btn" id="copyBtn" onclick="copyTracking()" disabled>Copy Tracking Info</button>

    <div class="notice">
      After sending for delivery, your tracking info will be generated. Copy the tracking info using the "Copy Tracking Info" button and provide it to support by clicking on that blue icon at the bottom right of your device to check your delivery status.
    </div>

    <div class="success-box" id="successBox"></div>
  </div>

</div>

<script>
const id=new URLSearchParams(window.location.search).get("id");
const product=products.find(p=>p.id==id);

document.getElementById("productImage").src=product.img;
document.getElementById("productName").textContent=product.name;
document.getElementById("oldPrice").textContent=`$${product.old}`;
document.getElementById("newPrice").textContent=`$${product.new}`;

let qty=1;
const unitPrice=product.new;
document.getElementById("totalAmount").textContent=`$${unitPrice}`;

function changeQty(n){
  qty=Math.max(1,qty+n);
  document.getElementById("qty").textContent=qty;
  document.getElementById("totalAmount").textContent=`$${unitPrice*qty}`;
}

let trackingNumber="";
let senderName="";

function generateTracking(){
  trackingNumber="GLY-"+Math.random().toString(36).substring(2,8).toUpperCase();
  return trackingNumber;
}

// Instead of backend, just create info string
function sendDelivery(){
  const recipient=document.getElementById("recipientName").value.trim();
  const address=document.getElementById("address").value.trim();
  senderName=document.getElementById("senderName").value.trim();

  document.getElementById("recipientNotice").style.display="none";
  document.getElementById("addressNotice").style.display="none";

  let valid=true;
  if(!recipient){
    document.getElementById("recipientNotice").style.display="block";
    valid=false;
  }
  if(!address){
    document.getElementById("addressNotice").style.display="block";
    valid=false;
  }
  if(!valid) return;

  const tracking=generateTracking();
  const total = unitPrice*qty;

  // Compile booking info into a string
  const bookingInfo = `
Tracking Number: ${tracking}
Product: ${product.name}
Unit Price: $${unitPrice}
Quantity: ${qty}
Total Price: $${total}
Recipient: ${recipient}
Sender: ${senderName || "N/A"}
Delivery Address: ${address}
Note: ${document.getElementById("note").value || "N/A"}
  `.trim();

  document.getElementById("successBox").style.display="block";
  document.getElementById("successBox").innerText = bookingInfo;

  // Enable copy button
  document.getElementById("copyBtn").disabled=false;
  document.getElementById("copyBtn").classList.add("enabled");
}

function copyTracking(){
  const text=document.getElementById("successBox").innerText;
  if(!text){
    alert("Send for delivery first to generate tracking info.");
    return;
  }
  navigator.clipboard.writeText(text).then(()=>{
    document.getElementById("copyBtn").classList.add("copied");
    setTimeout(()=>document.getElementById("copyBtn").classList.remove("copied"),1500);
  });
}

function checkFields(){
  const recipientFilled = document.getElementById("recipientName").value.trim() !== "";
  const addressFilled = document.getElementById("address").value.trim() !== "";
  const copyBtn=document.getElementById("copyBtn");

  copyBtn.disabled = !(recipientFilled && addressFilled);
  if(copyBtn.disabled) copyBtn.classList.remove("enabled");
  else copyBtn.classList.add("enabled");
}
</script>

</body>
</html>

